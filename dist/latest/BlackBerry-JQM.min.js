(function(e){e.widget("mobile.actionbar",e.mobile.widget,{options:{initSelector:":jqmData(role='actionbar')",backButtonText:e.mobile.page.prototype.options.backBtnText,disableTapToggle:!0},_init:function(){},_create:function(){this.actionBarArea=e(this.element),this.showActionOverflow=this.showTabOverflow=!1;var t,n,r,i=this,s=i.options,o=e(document.createElement("div")),u=e(document.createElement("div")),a=this.actionBarArea.children(":jqmData(role='action'), :jqmData(role='tab')"),f=a.filter(":jqmData(role='action')"),l=a.filter(":jqmData(role='tab')"),c=this.actionBarArea.children(":jqmData(role='back')").first(),h=f.length>0||l.length>4?3:4,p=l.not("[data-overflow]").length>0?f.length>1?0:1:3;e("[data-role=footer]").fixedtoolbar({tapToggle:!s.disableTapToggle}),this.actionBarArea.addClass("action-bar-area"),o.addClass("action-bar"),u.addClass("action-bar-actions"),e(".ui-input-text").focus(function(){e(".ui-footer, .ui-header").addClass("hidden")}).blur(function(){e(".ui-footer, .ui-header").removeClass("hidden")}),c.length&&!l.length?this._createBackButton(c,o):(c.remove(),u.addClass("action-bar-actions-full-width"));if(!a||a.length<1){var d=e(document.createElement("div"));d.addClass("action-bar-action-item"),u.append(d)}var v=l.length>h,m;for(var g=0;g<l.length;g++){n=l.eq(g);if(v||n.data("overflow")){var y=n.clone();this._addToTabOverflow(y);if(g>h-1||n.data("overflow")){n.remove();continue}(m=y.attr("id"))&&y.attr("data-for",m).attr("id","")}u.append(this._createTabItem(n))}for(g=0;g<f.length;g++){n=f.eq(g);if(g>p-1||n.data("overflow")){this._addToActionOverflow(n);continue}u.append(this._createActionItem(n))}this.showActionOverflow&&(this.overflowActionMenu.find(".menuItem").bind("vclick",{context:i},this._hideActionOverflow),this.overflowActionMenu.bind("vclick",function(e){return!1}),this._createOverflowButton(this.overflowActionMenu).addClass("actions").appendTo(u).bind("touchend",function(){i.overflowActionMenu.addClass("showMenu"),setTimeout(function(){e(document).bind("vclick",{context:i},i._hideActionOverflow)},0)}));if(this.showTabOverflow){var b=this._createOverflowButton(this.overflowTabMenu).addClass("tabs").addClass("action-bar-tab-item").prependTo(u).bind("vclick",function(t){e(".ui-page-active, .ui-footer-fixed, .ui-header-fixed").addClass("showTabHelper").addClass("showTabOverflow"),setTimeout(function(){e(".ui-page-active").one("touchend touchmove",function(t){e(".ui-page-active, .ui-footer-fixed, .ui-header-fixed").removeClass("showTabOverflow").one("webkitTransitionEnd",function(){e(this).removeClass("showTabHelper")})})},0)});this.overflowTabMenu.find(".menuItem").bind("vclick",function(){e(".ui-page-active, .ui-footer, .ui-header").removeClass("showTabOverflow"),b.empty(),e(this).find("img").clone().appendTo(b),e('<div class="action-bar-action-item-text"><p>'+e(this).text()+"</p></div>").appendTo(b),b.css("background-position-x","-50%"),e(".action-bar-tab-item:not(.action-bar-overflow)").one("vclick",function(){b.css("background-position-x","50%"),b.find("img").remove(),b.find(".action-bar-action-item-text").remove()})})}o.append(u),this.actionBarArea.append(o);var w,E,S;l.not("[data-overflow]").length>0?(E=this.actionBarArea.find(".action-bar-tab-item").not(".tabs"),S="action-bar-grid-"+(f.length>0?"tabAction":"tabs")):(E=this.actionBarArea.find(".action-bar-action-item"),S="action-bar-grid-actions"),w=E.length,S+="-"+(w>5?"e":String.fromCharCode(96+w)),E.addClass(S),e(".action-bar-action-item").bind("vmousedown",function(t){e(t.delegateTarget).addClass("pressed")}).bind("vmouseup",function(t){e(t.delegateTarget).removeClass("pressed")}),e(document).bind("actionbarIn",function(){i._animateIn(c,u)}).bind("actionbarOut",function(){i._animateOut(c,u)}),e("[data-for]").bind("vclick",function(t){e("#"+e(this).attr("data-for")).trigger(t.type),t.stopImmediatePropagation()})},refresh:function(){},destroy:function(){e(this.overflowActionMenu).remove(),e(this.overflowTabMenu).remove()},_createOverFlowItem:function(e){e.addClass("menuItem light-text-fade");var t=e.children("p").first().html();return e.children("p").remove(),e.append(t),e},_createActionItem:function(e){return e=this._createBarItem(e),e},_createTabItem:function(e){return e=this._createBarItem(e),e.addClass("action-bar-tab-item"),e},_createBarItem:function(t){var n=t.find("p").first(),r=t.find("img").first().addClass("action-bar-action-item-image").appendTo(t);t.addClass("action-bar-action-item");if(n)var i=e(document.createElement("div")).addClass("action-bar-action-item-text").html(n).appendTo(t);return t},_hideActionOverflow:function(t){var n=t.data.context;n.overflowActionMenu.removeClass("showMenu"),e(document).unbind("vclick",n._hideActionOverflow)},_addToTabOverflow:function(e){this.overflowTabMenu||(this.overflowTabMenu=this._createOverflowMenu(this.actionBarArea,!0),this.showTabOverflow=!0),this._addToOverflow(e,this.overflowTabMenu)},_addToActionOverflow:function(e){this.overflowActionMenu||(this.overflowActionMenu=this._createOverflowMenu(this.actionBarArea,!1),this.showActionOverflow=!0),this._addToOverflow(e,this.overflowActionMenu)},_addToOverflow:function(e,t){t||(this.showTabOverflow=!0),e=this._createOverFlowItem(e),e.appendTo(t.children(".overflowMenuContent").first())},_createBackButton:function(t,n){var r=e(document.createElement("div"));r.addClass("action-bar-back-text").html("<p>"+this.options.backButtonText+"</p>"),t.addClass("action-bar-back").append(r).bind("vmousedown",function(t){return e(t.delegateTarget).addClass("pressed"),window.history.back(),!1}).bind("vmouseup",function(t){e(t.delegateTarget).removeClass("pressed")}).appendTo(n)},_createOverflowMenu:function(t,n){var r=e(document.createElement("div")).addClass("overflowMenu"+(n?" left":"")),i=e(document.createElement("div")).addClass("overflowMenuContent").appendTo(r),s=t.closest(".ui-page").first();if(n){var o=document.createElement("div");o.className="ui-overflow-overlay",s.before(r),s[0].appendChild(o)}else s.append(r);return r},_createOverflowButton:function(t){return e(document.createElement("div")).addClass("action-bar-overflow")},_animateIn:function(e,t){e&&e.removeClass("action-bar-back-offset-right action-bar-back-offset-left"),t.removeClass("action-bar-actions-offset-right action-bar-actions-offset-left")},_animateOut:function(e,t,n,r){e&&e.addClass("action-bar-back-offset-right"),t.addClass("action-bar-actions-offset-right"),r&&t.on("webkitTransitionEnd",function i(){t.off("webkitTransitionEnd",i),r()})},_animateBelow:function(e,t){e&&e.addClass("action-bar-back-offset-left"),t.addClass("action-bar-actions-offset-left")}}),e(document).bind("pagecreate create",function(t){e.mobile.actionbar.prototype.enhanceWithin(t.target)})})(jQuery),function(e){e.widget("mobile.activityindicator",e.mobile.widget,{options:{initSelector:":jqmData(role='bb-activity-indicator')",size:"medium",theme:"c",speed:"2s"},_create:function(){var t=this.element.attr("data-theme"),n=this.element.attr("data-size");this.options.size=n!==undefined?n:this.options.size,this.options.theme=t!==undefined?t:this.options.theme,this.swirl=e(document.createElement("div")).addClass("bb-activity-swirl bb-activity-"+this.options.size),this.element.append(this.swirl).addClass("bb-activity bb-activity-bg-"+this.options.theme+" bb-activity-"+this.options.size)},display:function(e){e?this.element.removeClass("bb-activity-hidden"):this.element.addClass("bb-activity-hidden")},speed:function(e){this.swirl.css("-webkit-animation-duration",e)}}),e(document).bind("pagecreate create",function(t){e.mobile.activityindicator.prototype.enhanceWithin(t.target)})}(jQuery),function(e){e.widget("mobile.buttonGroup",e.mobile.widget,{options:{initSelector:':jqmData(role="controlgroup"):jqmData(type="horizontal")'},_create:function(){this.element.addClass("bb-buttongroup"),this.controlWrapper=this.element.children().addClass("bb-buttongroup-controls");var t=this.controlWrapper.children(),n=t.length,r=n%3;n>=3&&this.controlWrapper.addClass("bb-buttongroup-stacked");if(r===0)this.controlWrapper.addClass("ui-grid-b");else if(n===1)this.controlWrapper.addClass("ui-grid-solo");else if(n===2||n===4)this.controlWrapper.addClass("ui-grid-a");else{this.controlWrapper.addClass("ui-grid-b"),this.controlWrapperExtra=e(document.createElement("div")).addClass("bb-buttongroup-controls-extra ui-controlgroup-controls"),this.element.append(this.controlWrapperExtra);var i=t.slice(n-r,t.length);this.controlWrapperExtra.append(i),i.length===2?this.controlWrapperExtra.addClass("ui-grid-a"):i.length===1&&this.controlWrapperExtra.addClass("ui-grid-solo")}n>3&&(t.eq(0).removeClass("ui-corner-left").addClass("ui-corner-tl").children().removeClass("ui-corner-left").addClass("ui-corner-tl"),t.eq(n-1).removeClass("ui-corner-right").addClass("ui-corner-br").children().removeClass("ui-corner-right").addClass("ui-corner-br"),n===4?(t.eq(1).addClass("ui-corner-tr").children().addClass("ui-corner-tr"),t.eq(2).addClass("ui-corner-").css("margin-top","-2px").children().addClass("ui-corner-bl")):(t.eq(2).addClass("ui-corner-tr").children().addClass("ui-corner-tr"),r===0&&(r=3),t.eq(n-r).addClass("ui-corner-bl").children().addClass("ui-corner-bl")))}}),e(document).bind("pageinit create",function(t){e.mobile.buttonGroup.prototype.enhanceWithin(t.target)})}(jQuery),function(e){e.widget("mobile.gridview",e.mobile.widget,{options:{initSelector:":jqmData(role='gridview')",margin:.78125},_create:function(){var e=this;e.element.addClass(function(e,t){return t+" ui-gridview "}),e.refresh(!0)},_getChildrenByTagName:function(t,n,r){var i=[],s={};s[n]=s[r]=!0,t=t.firstChild;while(t)s[t.nodeName]&&i.push(t),t=t.nextSibling;return e(i)},refresh:function(){function l(e){return o*e+n.margin*(e+1)+"%"}this.parentPage=this.element.closest(".ui-page");var t=this,n=t.options,r=this.element,i=this._getChildrenByTagName(r[0],"div","DIV"),s=window.innerWidth||e(window).width(),o=0,u={},a,f;for(var c=0,h=i.length;c<h;c++){a=i.eq(c),f="ui-grid-li";if(a.jqmData("role")==="list-divider")f+=" ui-li ui-li-divider ui-bar-b",a.attr("role","heading");else{var p=this._getChildrenByTagName(a[0],"div","DIV");o=100/p.length-n.margin-n.margin/p.length;var d=p.find("p").addClass("ui-grid-item-details").css("width",o+"%").css("left",l).end().find("img").css("width",o+"%")}u[f]||(u[f]=[]),u[f].push(a[0])}for(f in u)e(u[f]).addClass(f).children(".ui-btn-inner").addClass(f);r.find("h1, h2, h3, h4, h5, h6").addClass("ui-li-heading"),r.find("a").removeClass("ui-link").addClass("ui-link-inherit")}}),e(document).bind("pagecreate create",function(t){e.mobile.gridview.prototype.enhanceWithin(t.target)})}(jQuery),function(e){e.widget("mobile.inputValidator",e.mobile.widget,{options:{initSelector:'input[type="text"]:jqmData(role="bb-inputvalidator"), input[type="search"]:jqmData(role="bb-inputvalidator")'},_create:function(){var t=this;this.element.addClass("bb-text-validated"),this.wrapper=e(document.createElement("div")).addClass("bb-text-validator");var n=e(this.element).parent("div.ui-input-search");n.length!==0?(n.addClass("bb-text-validated"),this.wrapper.insertBefore(n).append(n)):this.wrapper.insertBefore(this.element).append(this.element),this.icon=e(document.createElement("div")).addClass("bb-validation-icon").appendTo(this.wrapper),this._validate(e(this.element)),e(".bb-text-validated").bind("focus keyup blur",function(n){t._validate(e(n.target))})},_validate:function(e){var t=new RegExp(e.attr("pattern")),n=e.parent("div.ui-input-search"),r=e.add(n);if(e.attr("required")===undefined){if(e.val()===""&&!e.is(":focus")){r.addClass("bb-text-empty").removeClass("bb-text-valid").removeClass("bb-text-invalid");return}e.hasClass("bb-text-empty")&&!e.val()&&e.is(":focus")&&r.removeClass("bb-text-empty")}t.test(e.val())?r.addClass("bb-text-valid").removeClass("bb-text-invalid"):r.removeClass("bb-text-valid").addClass("bb-text-invalid")}}),e(document).bind("pagecreate create",function(t){e.mobile.inputValidator.prototype.enhanceWithin(t.target)})}(jQuery),function(e){e.widget("mobile.progressbar",e.mobile.widget,{options:{initSelector:"progress",color:"dark",highlightColor:"#00BC9F",accentColor:"rgb(-120, 68, 39)"},_create:function(){this.progress=this.element.css("display","none"),this.outerElement=e(document.createElement("div")).attr("class","bb-progress").insertBefore(this.progress).append(this.progress),this.outer=e(document.createElement("div")).attr("class","outer bb-progress-outer-"+this.options.color+" bb-progress-outer-idle-background-"+this.options.color).appendTo(this.outerElement),this.fill=e(document.createElement("div")).attr("class","bb-progress-fill bb10Highlight").appendTo(this.outer),this.inner=e(document.createElement("div")).attr("class","inner").appendTo(this.outer),this.outerElement.maxValue=this.progress.attr("max")?parseInt(this.progress.attr("max"),10):0,this.outerElement.value=this.progress.attr("value")?parseInt(this.progress.attr("value"),10):0,this.setValue(this.outerElement.value)},pause:function(e){var t=e!==undefined?e:!0;t?this.fill.addClass("paused"):this.fill.removeClass("paused")},setError:function(e){var t=e!==undefined?e:!0;t?this.fill.addClass("error"):this.fill.removeClass("error")},setValue:function(e){var t=0;if(e===undefined||e<0||e>this.outerElement.maxValue)return;this.outerElement.value=e,this.value=e,e>=this.outerElement.maxValue?(t=100,this.fill.addClass("completed").removeClass("active paused error")):e===0?this.outer.attr("class","outer bb-progress-outer-"+this.options.color+" bb-progress-outer-idle-background-"+this.options.color):(this.outer.attr("class","outer bb-progress-outer-"+this.options.color),this.fill.attr("class","bb-progress-fill bb10Highlight").css("background",""),this.fill.addClass("active").removeClass("completed paused error"),t=this.outerElement.value/parseInt(this.outerElement.maxValue,10)*100),this.fill.css("width",t+"%")}}),e(document).bind("pagecreate create",function(t){e.mobile.progressbar.prototype.enhanceWithin(t.target)})}(jQuery),function(e){e.widget("mobile.dropdown",e.mobile.widget,{options:{initSelector:""},_init:function(){},_create:function(){var t=this,n=e(this.element).parent(),r=e('<div data-role="collapsible" data-content-theme='+e.mobile.getInheritedTheme(n,"c")+' data-collapsed="true" data-iconpos="right">'),i=e(this.element),s=e('<ul data-role="listview"></ul>').appendTo(r);this.header=e("<h1></h1>").appendTo(r),i.find("option").each(function(n,r){var i=e(document.createElement("li")).text(e(r).text());e(r).attr("selected")==="selected"&&(t._setHeader(e(r).text()),i.addClass("checked")),s.append(i)}),i.css("display","none"),e("<div>").attr("data-enhance","false").wrap(i),n.after(r),r.parent().trigger("create"),n.remove(),i.remove(),setTimeout(function(){i.appendTo(r)},0),s.bind("vclick",function(n){var s=e(n.target);t._setHeader(s.text()),e(".checked").removeClass("checked"),s.addClass("checked"),i.prop("value",i.find('option:contains("'+s.text()+'")').attr("value")),i.trigger("change"),r.trigger("collapse")})},_setHeader:function(e){var t=this.header.find(".ui-btn-text"),n=t.find(".ui-collapsible-heading-status");t.length===0?this.header.text(e):t.text(e).append(n)},refresh:function(){}}),e(document).unbind("selectmenubeforecreate"),e(document).bind("selectmenubeforecreate",function(t){e(t.target).dropdown()})}(jQuery);