(function(a){a.widget("mobile.actionbar",a.mobile.widget,{options:{initSelector:":jqmData(role='actionbar')",backButtonText:a.mobile.page.prototype.options.backBtnText,disableTapToggle:!0},_init:function(){},_create:function(){this.actionBarArea=a(this.element),this.showActionOverflow=this.showTabOverflow=!1;var b,c,d,e=this,f=e.options,g=a(document.createElement("div")),h=a(document.createElement("div")),i=this.actionBarArea.children(":jqmData(role='action'), :jqmData(role='tab')"),j=i.filter(":jqmData(role='action')"),k=i.filter(":jqmData(role='tab')"),l=this.actionBarArea.children(":jqmData(role='back')").first(),m=j.length>0||k.length>4?3:4,n=k.not("[data-overflow]").length>0?j.length>1?0:1:3;a("[data-role=footer]").fixedtoolbar({tapToggle:!f.disableTapToggle}),this.actionBarArea.addClass("action-bar-area"),g.addClass("action-bar"),h.addClass("action-bar-actions"),a(".ui-input-text").focus(function(){a(".ui-footer, .ui-header").addClass("hidden")}).blur(function(){a(".ui-footer, .ui-header").removeClass("hidden")}),l.length&&!k.length?this._createBackButton(l,g):(l.remove(),h.addClass("action-bar-actions-full-width"));if(!i||i.length<1){var o=a(document.createElement("div"));o.addClass("action-bar-action-item"),h.append(o)}var p=k.length>m,q;for(var r=0;r<k.length;r++){c=k.eq(r);if(p||c.data("overflow")){var s=c.clone();this._addToTabOverflow(s);if(r>m-1||c.data("overflow")){c.remove();continue}(q=s.attr("id"))&&s.attr("data-for",q).attr("id","")}h.append(this._createTabItem(c))}for(r=0;r<j.length;r++){c=j.eq(r);if(r>n-1||c.data("overflow")){this._addToActionOverflow(c);continue}h.append(this._createActionItem(c))}this.showActionOverflow&&(this.overflowActionMenu.find(".menuItem").bind("vclick",{context:e},this._hideActionOverflow),this._createOverflowButton(this.overflowActionMenu).addClass("actions").appendTo(h).bind("touchend",function(){e.overflowActionMenu.addClass("showMenu"),setTimeout(function(){a(document).bind("vclick",{context:e},e._hideActionOverflow)},0)}));if(this.showTabOverflow){var t=this._createOverflowButton(this.overflowTabMenu).addClass("tabs").addClass("action-bar-tab-item").prependTo(h).bind("vclick",function(b){a(".ui-page-active, .ui-footer-fixed, .ui-header-fixed").addClass("showTabHelper").addClass("showTabOverflow"),setTimeout(function(){a(".ui-page-active").one("touchend touchmove",function(b){a(".ui-page-active, .ui-footer-fixed, .ui-header-fixed").removeClass("showTabOverflow").one("webkitTransitionEnd",function(){a(this).removeClass("showTabHelper")})})},0)});this.overflowTabMenu.find(".menuItem").bind("vclick",function(){a(".ui-page-active, .ui-footer, .ui-header").removeClass("showTabOverflow"),t.empty(),a(this).find("img").clone().appendTo(t),a('<div class="action-bar-action-item-text"><p>'+a(this).text()+"</p></div>").appendTo(t),t.css("background-position-x","-50%"),a(".action-bar-tab-item:not(.action-bar-overflow)").one("vclick",function(){t.css("background-position-x","50%"),t.find("img").remove(),t.find(".action-bar-action-item-text").remove()})})}g.append(h),this.actionBarArea.append(g);var u,v,w;k.not("[data-overflow]").length>0?(v=this.actionBarArea.find(".action-bar-tab-item").not(".tabs"),w="action-bar-grid-"+(j.length>0?"tabAction":"tabs")):(v=this.actionBarArea.find(".action-bar-action-item"),w="action-bar-grid-actions"),u=v.length,w+="-"+(u>5?"e":String.fromCharCode(96+u)),v.addClass(w),a(".action-bar-action-item").bind("vmousedown",function(b){a(b.delegateTarget).addClass("pressed")}).bind("vmouseup",function(b){a(b.delegateTarget).removeClass("pressed")}),a(document).bind("actionbarIn",function(){e._animateIn(l,h)}).bind("actionbarOut",function(){e._animateOut(l,h)}),a("[data-for]").bind("vclick",function(b){a("#"+a(this).attr("data-for")).trigger(b.type),b.stopImmediatePropagation()})},refresh:function(){},destroy:function(){a(this.overflowActionMenu).remove(),a(this.overflowTabMenu).remove()},_createOverFlowItem:function(a){a.addClass("menuItem light-text-fade");var b=a.children("p").first().html();return a.children("p").remove(),a.append(b),a},_createActionItem:function(a){return a=this._createBarItem(a),a},_createTabItem:function(a){return a=this._createBarItem(a),a.addClass("action-bar-tab-item"),a},_createBarItem:function(b){var c=b.find("p").first(),d=b.find("img").first().addClass("action-bar-action-item-image").appendTo(b);b.addClass("action-bar-action-item");if(c)var e=a(document.createElement("div")).addClass("action-bar-action-item-text").html(c).appendTo(b);return b},_hideActionOverflow:function(b){var c=b.data.context;c.overflowActionMenu.removeClass("showMenu"),a(document).unbind("vclick",c._hideActionOverflow)},_addToTabOverflow:function(a){this.overflowTabMenu||(this.overflowTabMenu=this._createOverflowMenu(this.actionBarArea,!0),this.showTabOverflow=!0),this._addToOverflow(a,this.overflowTabMenu)},_addToActionOverflow:function(a){this.overflowActionMenu||(this.overflowActionMenu=this._createOverflowMenu(this.actionBarArea,!1),this.showActionOverflow=!0),this._addToOverflow(a,this.overflowActionMenu)},_addToOverflow:function(a,b){b||(this.showTabOverflow=!0),a=this._createOverFlowItem(a),a.appendTo(b.children(".overflowMenuContent").first())},_createBackButton:function(b,c){var d=a(document.createElement("div"));d.addClass("action-bar-back-text").html("<p>"+this.options.backButtonText+"</p>"),b.addClass("action-bar-back").append(d).bind("vmousedown",function(b){return a(b.delegateTarget).addClass("pressed"),window.history.back(),!1}).bind("vmouseup",function(b){a(b.delegateTarget).removeClass("pressed")}).appendTo(c)},_createOverflowMenu:function(b,c){var d=a(document.createElement("div")).addClass("overflowMenu"+(c?" left":"")),e=a(document.createElement("div")).addClass("overflowMenuContent").appendTo(d),f=b.closest(".ui-page").first(),g=document.createElement("div");return g.className="ui-overflow-overlay",c?f.before(d):f.append(d),f[0].appendChild(g),d},_createOverflowButton:function(b){return a(document.createElement("div")).addClass("action-bar-overflow")},_animateIn:function(a,b){a&&a.removeClass("action-bar-back-offset-right action-bar-back-offset-left"),b.removeClass("action-bar-actions-offset-right action-bar-actions-offset-left")},_animateOut:function(a,b,c,d){a&&a.addClass("action-bar-back-offset-right"),b.addClass("action-bar-actions-offset-right"),d&&b.on("webkitTransitionEnd",function e(){b.off("webkitTransitionEnd",e),d()})},_animateBelow:function(a,b){a&&a.addClass("action-bar-back-offset-left"),b.addClass("action-bar-actions-offset-left")}}),a(document).bind("pagecreate create",function(b){a.mobile.actionbar.prototype.enhanceWithin(b.target)})})(jQuery),function(a){a.widget("mobile.activityindicator",a.mobile.widget,{options:{initSelector:":jqmData(role='bb-activity-indicator')",size:"medium",theme:"c",speed:"2s"},_create:function(){var b=this.element.attr("data-theme"),c=this.element.attr("data-size");this.options.size=c!==undefined?c:this.options.size,this.options.theme=b!==undefined?b:this.options.theme,this.swirl=a(document.createElement("div")).addClass("bb-activity-swirl bb-activity-"+this.options.size),this.element.append(this.swirl).addClass("bb-activity bb-activity-bg-"+this.options.theme+" bb-activity-"+this.options.size)},display:function(a){a?this.element.removeClass("bb-activity-hidden"):this.element.addClass("bb-activity-hidden")},speed:function(a){this.swirl.css("-webkit-animation-duration",a)}}),a(document).bind("pagecreate create",function(b){a.mobile.activityindicator.prototype.enhanceWithin(b.target)})}(jQuery),function(a){a.widget("mobile.buttonGroup",a.mobile.widget,{options:{initSelector:':jqmData(role="controlgroup"):jqmData(type="horizontal")'},_create:function(){this.element.addClass("bb-buttongroup"),this.controlWrapper=this.element.children().addClass("bb-buttongroup-controls");var b=this.controlWrapper.children(),c=b.length,d=c%3;c>=3&&this.controlWrapper.addClass("bb-buttongroup-stacked");if(d===0)this.controlWrapper.addClass("ui-grid-b");else if(c===1)this.controlWrapper.addClass("ui-grid-solo");else if(c===2||c===4)this.controlWrapper.addClass("ui-grid-a");else{this.controlWrapper.addClass("ui-grid-b"),this.controlWrapperExtra=a(document.createElement("div")).addClass("bb-buttongroup-controls-extra ui-controlgroup-controls"),this.element.append(this.controlWrapperExtra);var e=b.slice(c-d,b.length);this.controlWrapperExtra.append(e),e.length===2?this.controlWrapperExtra.addClass("ui-grid-a"):e.length===1&&this.controlWrapperExtra.addClass("ui-grid-solo")}c>3&&(b.eq(0).removeClass("ui-corner-left").addClass("ui-corner-tl").children().removeClass("ui-corner-left").addClass("ui-corner-tl"),b.eq(c-1).removeClass("ui-corner-right").addClass("ui-corner-br").children().removeClass("ui-corner-right").addClass("ui-corner-br"),c===4?(b.eq(1).addClass("ui-corner-tr").children().addClass("ui-corner-tr"),b.eq(2).addClass("ui-corner-").css("margin-top","-2px").children().addClass("ui-corner-bl")):(b.eq(2).addClass("ui-corner-tr").children().addClass("ui-corner-tr"),d===0&&(d=3),b.eq(c-d).addClass("ui-corner-bl").children().addClass("ui-corner-bl")))}}),a(document).bind("pageinit create",function(b){a.mobile.buttonGroup.prototype.enhanceWithin(b.target)})}(jQuery),function(a){a.widget("mobile.gridview",a.mobile.widget,{options:{initSelector:":jqmData(role='gridview')",margin:.78125},_create:function(){var a=this;a.element.addClass(function(a,b){return b+" ui-gridview "}),a.refresh(!0)},_getChildrenByTagName:function(b,c,d){var e=[],f={};f[c]=f[d]=!0,b=b.firstChild;while(b)f[b.nodeName]&&e.push(b),b=b.nextSibling;return a(e)},refresh:function(){function k(a){return g*a+c.margin*(a+1)+"%"}this.parentPage=this.element.closest(".ui-page");var b=this,c=b.options,d=this.element,e=this._getChildrenByTagName(d[0],"div","DIV"),f=window.innerWidth||a(window).width(),g=0,h={},i,j;for(var l=0,m=e.length;l<m;l++){i=e.eq(l),j="ui-grid-li";if(i.jqmData("role")==="list-divider")j+=" ui-li ui-li-divider ui-bar-b",i.attr("role","heading");else{var n=this._getChildrenByTagName(i[0],"div","DIV");g=100/n.length-c.margin-c.margin/n.length;var o=n.find("p").addClass("ui-grid-item-details").css("width",g+"%").css("left",k).end().find("img").css("width",g+"%")}h[j]||(h[j]=[]),h[j].push(i[0])}for(j in h)a(h[j]).addClass(j).children(".ui-btn-inner").addClass(j);d.find("h1, h2, h3, h4, h5, h6").addClass("ui-li-heading"),d.find("a").removeClass("ui-link").addClass("ui-link-inherit")}}),a(document).bind("pagecreate create",function(b){a.mobile.gridview.prototype.enhanceWithin(b.target)})}(jQuery),function(a){a.widget("mobile.inputValidator",a.mobile.widget,{options:{initSelector:'input[type="text"]:jqmData(role="bb-inputvalidator"), input[type="search"]:jqmData(role="bb-inputvalidator")'},_create:function(){var b=this;this.element.addClass("bb-text-validated"),this.wrapper=a(document.createElement("div")).addClass("bb-text-validator");var c=a(this.element).parent("div.ui-input-search");c.length!==0?(c.addClass("bb-text-validated"),this.wrapper.insertBefore(c).append(c)):this.wrapper.insertBefore(this.element).append(this.element),this.icon=a(document.createElement("div")).addClass("bb-validation-icon").appendTo(this.wrapper),this._validate(a(this.element)),a(".bb-text-validated").bind("focus keyup blur",function(c){b._validate(a(c.target))})},_validate:function(a){var b=new RegExp(a.attr("pattern")),c=a.parent("div.ui-input-search"),d=a.add(c);if(a.attr("required")===undefined){if(a.val()===""&&!a.is(":focus")){d.addClass("bb-text-empty").removeClass("bb-text-valid").removeClass("bb-text-invalid");return}a.hasClass("bb-text-empty")&&!a.val()&&a.is(":focus")&&d.removeClass("bb-text-empty")}b.test(a.val())?d.addClass("bb-text-valid").removeClass("bb-text-invalid"):d.removeClass("bb-text-valid").addClass("bb-text-invalid")}}),a(document).bind("pagecreate create",function(b){a.mobile.inputValidator.prototype.enhanceWithin(b.target)})}(jQuery),function(a){a.widget("mobile.progressbar",a.mobile.widget,{options:{initSelector:"progress",color:"dark",highlightColor:"#00BC9F",accentColor:"rgb(-120, 68, 39)"},_create:function(){this.progress=this.element.css("display","none"),this.outerElement=a(document.createElement("div")).attr("class","bb-progress").insertBefore(this.progress).append(this.progress),this.outer=a(document.createElement("div")).attr("class","outer bb-progress-outer-"+this.options.color+" bb-progress-outer-idle-background-"+this.options.color).appendTo(this.outerElement),this.fill=a(document.createElement("div")).attr("class","bb-progress-fill bb10Highlight").appendTo(this.outer),this.inner=a(document.createElement("div")).attr("class","inner").appendTo(this.outer),this.outerElement.maxValue=this.progress.attr("max")?parseInt(this.progress.attr("max"),10):0,this.outerElement.value=this.progress.attr("value")?parseInt(this.progress.attr("value"),10):0,this.setValue(this.outerElement.value)},pause:function(a){var b=a!==undefined?a:!0;b?this.fill.addClass("paused"):this.fill.removeClass("paused")},setError:function(a){var b=a!==undefined?a:!0;b?this.fill.addClass("error"):this.fill.removeClass("error")},setValue:function(a){var b=0;if(a===undefined||a<0||a>this.outerElement.maxValue)return;this.outerElement.value=a,this.value=a,a>=this.outerElement.maxValue?(b=100,this.fill.addClass("completed").removeClass("active paused error")):a===0?this.outer.attr("class","outer bb-progress-outer-"+this.options.color+" bb-progress-outer-idle-background-"+this.options.color):(this.outer.attr("class","outer bb-progress-outer-"+this.options.color),this.fill.attr("class","bb-progress-fill bb10Highlight").css("background",""),this.fill.addClass("active").removeClass("completed paused error"),b=this.outerElement.value/parseInt(this.outerElement.maxValue,10)*100),this.fill.css("width",b+"%")}}),a(document).bind("pagecreate create",function(b){a.mobile.progressbar.prototype.enhanceWithin(b.target)})}(jQuery),function(a){a.widget("mobile.dropdown",a.mobile.widget,{options:{initSelector:""},_init:function(){},_create:function(){var b=this,c=a(this.element).parent(),d=a('<div data-role="collapsible" data-content-theme='+a.mobile.getInheritedTheme(c,"c")+' data-collapsed="true" data-iconpos="right">'),e=a(this.element),f=a('<ul data-role="listview"></ul>').appendTo(d);this.header=a("<h1></h1>").appendTo(d),e.find("option").each(function(c,d){var e=a(document.createElement("li")).text(a(d).text());a(d).attr("selected")==="selected"&&(b._setHeader(a(d).text()),e.addClass("checked")),f.append(e)}),e.css("display","none"),a("<div>").attr("data-enhance","false").wrap(e),c.after(d),d.parent().trigger("create"),c.remove(),setTimeout(function(){e.appendTo(d)},0),f.bind("vclick",function(c){var f=a(c.target);b._setHeader(f.text()),a(".checked").removeClass("checked"),f.addClass("checked"),e.prop("value",e.find('option:contains("'+f.text()+'")').attr("value")),e.trigger("change"),d.trigger("collapse")})},_setHeader:function(a){var b=this.header.find(".ui-btn-text"),c=b.find(".ui-collapsible-heading-status");b.length===0?this.header.text(a):b.text(a).append(c)},refresh:function(){}}),a(document).unbind("selectmenubeforecreate"),a(document).bind("selectmenubeforecreate",function(b){a(b.target).dropdown()})}(jQuery);